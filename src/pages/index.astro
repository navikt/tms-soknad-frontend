---
import Layout from '../layouts/Layout.astro';
import type { Language } from '../language/language';
import type { SoknadsObject } from "@src/components/soknad/SoknadType";
import AlleSoknader from "@src/components/alle-soknader/AlleSoknader.tsx"
import { fetchAlleSoknader } from '@src/utils/server/fetchAlleSoknader';

let soknader: SoknadsObject[] | null = null;
let soknadsFetchError: boolean = false;

try {
  soknader = await fetchAlleSoknader(Astro.locals.token);
} catch (error: any) {
  console.log(error)
  console.error('Fetch failed.', error.message);
  soknadsFetchError = true;
}

const language = Astro.currentLocale as Language;
---

<Layout>
  <AlleSoknader soknader={soknader}/>
</Layout>
